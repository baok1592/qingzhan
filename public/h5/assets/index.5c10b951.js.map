{"version":3,"file":"index.5c10b951.js","sources":["../../../../../utils/common.js","../../../../../api/request.js","../../../../../utils/storage.js","../../../../../api/index.js"],"sourcesContent":["export function day(date) {\r\n\tif (!date) {\r\n\t\treturn '';\r\n\t}\r\n\tdate = new Date(date*1000);\r\n\tconst year = date.getFullYear()\r\n\tconst month = date.getMonth() + 1\r\n\tconst day = date.getDate()\r\n\tconst res=[year, month, day].join('-') \r\n\treturn res\r\n}\r\n\r\nexport function times(date) {\r\n\tif (!date) {\r\n\t\treturn '';\r\n\t}\r\n\tdate = new Date(date);\r\n\tconst year = date.getFullYear()\r\n\tconst month = date.getMonth() + 1\r\n\tconst day = date.getDate()\r\n\tconst hour = date.getHours()\r\n\tconst minute = date.getMinutes()\r\n\tconst second = date.getSeconds()\r\n\treturn [year, month, day].join('-') + ' ' + [hour, minute, second].join(':')\r\n}\r\n//返回字符串调用同名组件的 对象,适用于未全局引入的组件\r\n//如hero组件下面的ab组件\r\nexport function strAsCmp(modules) {\r\n\tconst obj = reactive({})\r\n\tObject.keys(modules).forEach(key => {\r\n\t\tconst one = modules[key]\r\n\t\tobj[key] = []\r\n\t\tObject.keys(one).forEach(k => {\r\n\t\t\tconst two = one[k]\r\n\t\t\tobj[key][k] = two\r\n\t\t})\r\n\t})\r\n\treturn obj\r\n}\n\r\n//详情页图片正则替换\r\nexport function min_img(content){\r\n\t\tconsole.log(\"asd\");\r\n\t\tlet s=content.replace('style=\"\"',\"\");\n    s=s.replace(/\\<img/gi, '<img class=\"my-3\" style=\"max-width:100%;height:auto\"')\r\n\t\treturn s;\n}\r\n\r\nexport function jumpUtil(type,pathOrid){\r\n\tlet url=`/pages/${type}/${type}?id=`+pathOrid\r\n\tif(type==='detail'){\r\n\t\turl=\"/pages/detail/detail\"+pathOrid\r\n\t}\r\n\tuni.navigateTo({\r\n\t\turl\r\n\t});\r\n}","import {\r\n\tapiUrl\r\n} from './config'\r\n\r\n\r\n\r\nfunction uni_request(url, param, method, again_quest = false) {\r\n\treturn new Promise((cback, reject) => {\r\n\t\t\tuni.request({\r\n\t\t\t\turl: apiUrl + url,\r\n\t\t\t\tdata: param,\r\n\t\t\t\tmethod: method\r\n\t\t\t}).then(res => {  \r\n\t\t\t\tconst {data, success,code} = res.data;\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tif (code == 200) {\r\n\t\t\t\t\tcback(data);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('201')\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}).catch(err => {\r\n\t\t\t\tconsole.log('catch:', err);\r\n\t\t\t})\r\n\t})\r\n}\r\n\r\nexport const post = (url, param=\"\") => {\r\n\treturn uni_request(url, param, 'POST')\r\n}\r\n\r\nexport const get = (url, param=\"\") => {\r\n\treturn uni_request(url, param, 'GET')\r\n}\n","\r\nimport { onPullDownRefresh } from '@dcloudio/uni-app'; \r\n// 默认缓存期限为10分钟\nconst DEFAULT_CACHE_TIME = 60 * 1\r\n\r\n\t \n/**\n * 创建本地缓存对象 \n */\r\n\nconst createStorage = ( prefixKey = '' ) => {\n  //本地缓存类\r\n\t\r\n \n  const Storage = class { \n    prefixKey = prefixKey\n    getKey(key) {\n      return `${this.prefixKey}${key}`.toUpperCase()\n    }\n\n    //设置缓存\n    set(key, value, expire=DEFAULT_CACHE_TIME) { \n      const stringData = JSON.stringify({\n        value,\n        expire: expire !== null ? new Date().getTime() + expire * 1000 : null\n      })\n      uni.setStorageSync(this.getKey(key), stringData)\n    }\n\n    //读取缓存\n    get(key, def = null) {\n      const item = uni.getStorageSync(this.getKey(key))\n      if (item) {\n        try {\n          const data = JSON.parse(item)\n          const { value, expire } = data\n          // 在有效期内直接返回\n          if (expire === null || expire >= Date.now()) {\n            return value\n          }\n          this.remove(key)\n        } catch (e) {\n          return def\n        }\n      }\n      return def\n    }\n\n    //从缓存删除某项\n    remove(key) {\n      uni.removeStorageSync(this.getKey(key))\n    }\n\n    //清空所有缓存\n    clear(){\n      uni.clearStorage();\n    }\n  }\n  return new Storage() \n}\n\nexport const storage = createStorage()\n\nexport default Storage\n","//首页接口\nimport {get,post} from './request'\r\nimport {storage} from '@/utils/storage.js' \r\n\n\n//首页数据\nexport const apiIndexData = async (num) => { \r\n\t\r\n\t//num等于2为下拉刷新，不调用缓存\r\n\tconst cache=storage.get('indexdata')\r\n\tif(cache && num!==2){\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tresolve(cache)\r\n\t\t})\r\n\t}\r\n  return get('index').then(res=>{\r\n\t\t//storage.set('indexdata',res)\r\n\t\treturn res\r\n\t})\n}\n\r\n//站点信息\nexport const apiSysData = async () => {  \r\n  return get('sys')\n}\n\n//内容详情1\nexport const apiDetailData = (cid,id) => { \r\n  return get('detail',{cid,id})\n}\n \r\n//内容详情2\r\nexport const apiDetailDataByType = (type,id) => { \r\n   return get('detail',{type,id})\r\n}\n "],"names":["date","Date","getFullYear","getMonth","getDate","join","content","log","s","replace","type","pathOrid","url","get","param","method","again_quest","Promise","cback","reject","apiUrl","data","then","success","code","res","catch","err","uni_request","storage","prefixKey","constructor","getKey","key","this","toUpperCase","set","value","expire","stringData","JSON","stringify","getTime","def","item","uni.getStorageSync","parse","now","remove","e","clear","createStorage","apiIndexData","async","num","cache","resolve","apiSysData","apiDetailData","cid","id","apiDetailDataByType"],"mappings":"4RAAO,WAAaA,OACdA,QACG,SAME,IAJH,IAAIC,KAAU,IAALD,IACEE,cACJF,EAAKG,WAAa,EACpBH,EAAKI,WACYC,KAAK,KAiC5B,WAAiBC,WACdC,IAAI,WACRC,EAAEF,EAAQG,QAAQ,WAAW,aAC7BD,EAAEC,QAAQ,UAAW,wDAClBD,EAGF,WAAkBE,EAAKC,OACzBC,EAAI,UAAUF,KAAQA,QAAWC,EAC3B,WAAPD,MACE,uBAAuBC,KAEb,CACdC,IAAAA,ICxBU,MAACC,EAAM,CAACD,EAAKE,EAAM,KAxB/B,SAAqBF,EAAKE,EAAOC,EAAQC,GAAc,UAC/C,IAAIC,SAAQ,CAACC,EAAOC,OACb,CACXP,IAAKQ,EAASR,EACdS,KAAMP,EACNC,OAAAA,IACEO,gBACID,KAACA,UAAME,OAAQC,GAAQC,EAAIJ,SAErB,KAARG,IACGH,WAEEd,IAAI,UAEXmB,mBACMnB,IAAI,SAAUoB,SAUlBC,CAAYhB,EAAKE,EAAO,oDC8BnBe,EAnDS,EAAEC,EAAY,KAgD3B,IA5CS,MAAAC,iCACFD,GACZE,OAAOC,SACE,GAAGC,KAAKJ,YAAYG,IAAME,cAInCC,IAAIH,EAAKI,EAAOC,EAlBO,UAmBfC,EAAaC,KAAKC,UAAU,CAChCJ,MAAAA,EACAC,OAAmB,OAAXA,GAAkB,IAAIrC,MAAOyC,UAAqB,IAATJ,EAAgB,SAEhDJ,KAAKF,OAAOC,GAAMM,GAIvC1B,IAAIoB,EAAKU,EAAM,YACPC,EAAOC,EAAmBX,KAAKF,OAAOC,OACxCW,YAEMvB,EAAOmB,KAAKM,MAAMF,IAClBP,MAAEA,SAAOC,GAAWjB,KAEX,OAAXiB,GAAmBA,GAAUrC,KAAK8C,aAC7BV,OAEJW,OAAOf,SACLgB,UACAN,SAGJA,EAITK,OAAOf,KACiBC,KAAKF,OAAOC,IAIpCiB,cAOmBC,GCvDVC,EAAeC,MAAOC,UAG5BC,EAAM1B,EAAQhB,IAAI,oBACrB0C,GAAe,IAAND,EACJ,IAAIrC,SAAQ,CAACuC,EAASrC,OACpBoC,MAGF1C,EAAI,SAASS,SAEbG,KAKIgC,EAAaJ,SACjBxC,EAAI,OAIA6C,EAAgB,CAACC,EAAIC,IACzB/C,EAAI,SAAS,CAAC8C,IAAAA,EAAIC,GAAAA,IAIdC,EAAsB,CAACnD,EAAKkD,IAC/B/C,EAAI,SAAS,CAACH,KAAAA,EAAKkD,GAAAA"}