"use strict";(self["webpackChunkqz_cms"]=self["webpackChunkqz_cms"]||[]).push([[939],{6227:function(e,l,a){a(4991)},3305:function(e,l,a){a.d(l,{F8:function(){return d},YA:function(){return o},Zy:function(){return r},kA:function(){return i},sj:function(){return u},t$:function(){return n},vO:function(){return m}});var t=a(1161);const u=()=>(0,t.Z)({url:"card_all"}),d=e=>(0,t.Z)({url:"card_cid_ctx?cid="+e}),n=e=>(0,t.Z)({url:"card_del?id="+e,method:"DELETE"}),o=e=>(0,t.W)({url:"card_detail?id="+e}),i=e=>(0,t.Z)({url:"card_add",method:"POST",data:e}),r=e=>(0,t.Z)({url:"card_up",method:"POST",data:e}),m=(e,l)=>(0,t.Z)({url:"card_state?type="+e+"&id="+l,method:"PUT"})},3127:function(e,l,a){a.d(l,{v:function(){return d},y:function(){return n}});var t=a(771),u=a(5793);const d=e=>{const l=(0,t.WJ)(1e3*e,"YYYY-MM-DD");return l.value},n=()=>{const e=u.t.get("Category"),l=[];return e.forEach((e=>{l.push({id:e.id,name:e.name,type:e.type}),e.children&&e.children.length>0&&e.children.forEach((e=>{l.push({id:e.id,name:e.name,type:e.type})}))})),l}},4389:function(e,l,a){a.r(l),a.d(l,{default:function(){return H}});var t=a(4645),u=(a(126),a(2270),a(6309),a(2521),a(8364),a(4122),a(6972),a(3504),a(5029),a(6826),a(2262)),d=a(6252),n=(a(6227),a(5288)),o=a(9546),i=a(489),r=a(4317),m=a(3236),c=a(2723),s=a(3276),f=a(865),_=a(3424),p=a(3305),v=a(5088),w=a(961),g=a(3127),y=a(8611);const W={class:"page-article-add right-main"},U={class:"top-back flex mb-4"},h=(0,d.Uk)(" 返 回"),k={class:"ctx_add py-2"},S={class:"imgs flex"},V=["src"],b={class:"editBox"},C=(0,d.Uk)(" 提交 "),Z=(0,d.Uk)(" 提交修改 ");var j=(0,d.aZ)({setup(e){const{Editor:l,Toolbar:a,editorRef:j,mode:x,toolbarConfig:D,editorConfig:H,handleCreated:q,getToolInfo:Y}=(0,y.r)(),E=(0,u.iH)(!1),P=(0,u.iH)(6),T=(0,u.iH)([]),z=(0,u.iH)(),A=(0,u.iH)(!1),O=(0,u.qj)({data:{title:"",desc:"",content:"",jump_url:"",img_ids:[],category_id:0}});let R=0;(0,d.bv)((()=>{z.value=(0,g.y)(),v.ZP.currentRoute.value&&v.ZP.currentRoute.value.query.id&&(R=v.ZP.currentRoute.value.query.id,B(R))}));const B=async e=>{const l=await(0,p.YA)(e);O.data=l,K.value=!!l.jump_url,A.value=!0,T.value=l.urls},I=(e,l)=>{O.data.img_ids.length<1?(T.value=l,O.data.img_ids=e):(T.value.push(...l),O.data.img_ids.push(...e))},L=()=>{P.value=6-T.value.length,E.value=!0},F=e=>{O.data.img_ids.splice(e,1),T.value.splice(e,1)},K=(0,u.iH)(!1),M=()=>{K.value?O.data.content="":O.data.jump_url="",(0,p.kA)(O.data).then((e=>{t.z8.success("创建成功"),v.ZP.push("/cards/list")}))},J=()=>{let e=(0,u.IU)(O.data);K.value||(e.jump_url=""),e.id=R,e.date=e.date/1e3,(0,p.Zy)(e).then((e=>{t.z8.success("修改成功"),v.ZP.push("/cards/list")}))};return(e,t)=>{const p=(0,d.up)("ArrowLeft"),v=f.gn,g=s.mi,y=(0,d.up)("router-link"),Y=c.EZ,R=n.nH,B=m.Dv,X=r.Xb,$=i.dq,G=o.BT,N=o.km,Q=(0,d.up)("circle-close"),ee=(0,d.up)("plus"),le=n.ly;return(0,d.wg)(),(0,d.iD)("div",W,[(0,d._)("div",U,[(0,d.Wm)(y,{to:"/cards/list"},{default:(0,d.w5)((()=>[(0,d.Wm)(g,{type:"primary"},{default:(0,d.w5)((()=>[(0,d.Wm)(v,null,{default:(0,d.w5)((()=>[(0,d.Wm)(p)])),_:1}),h])),_:1})])),_:1})]),(0,d._)("div",k,[(0,d.Wm)(le,{model:(0,u.SU)(O),"label-width":"100px"},{default:(0,d.w5)((()=>[(0,d.Wm)($,null,{default:(0,d.w5)((()=>[(0,d.Wm)(B,{span:14},{default:(0,d.w5)((()=>[(0,d.Wm)(R,{label:"标题"},{default:(0,d.w5)((()=>[(0,d.Wm)(Y,{modelValue:(0,u.SU)(O).data.title,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,u.SU)(O).data.title=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,d.Wm)(B,{span:2},{default:(0,d.w5)((()=>[(0,d.Wm)(R,{label:"跳转"},{default:(0,d.w5)((()=>[(0,d.Wm)(X,{modelValue:K.value,"onUpdate:modelValue":t[1]||(t[1]=e=>K.value=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,d.Wm)($,null,{default:(0,d.w5)((()=>[K.value?((0,d.wg)(),(0,d.j4)(B,{key:0,span:16},{default:(0,d.w5)((()=>[(0,d.Wm)(R,{label:"跳转到"},{default:(0,d.w5)((()=>[(0,d.Wm)(Y,{modelValue:(0,u.SU)(O).data.jump_url,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,u.SU)(O).data.jump_url=e),placeholder:"请输入网址"},null,8,["modelValue"])])),_:1})])),_:1})):(0,d.kq)("",!0)])),_:1}),(0,d.Wm)($,null,{default:(0,d.w5)((()=>[(0,d.Wm)(B,{span:8},{default:(0,d.w5)((()=>[(0,d.Wm)(R,{label:"栏目"},{default:(0,d.w5)((()=>[(0,d.Wm)(N,{modelValue:(0,u.SU)(O).data.category_id,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,u.SU)(O).data.category_id=e),placeholder:""},{default:(0,d.w5)((()=>[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(z.value,(e=>((0,d.wg)(),(0,d.iD)(d.HY,{key:e.id},["cards"==e.type?((0,d.wg)(),(0,d.j4)(G,{key:0,label:e.name,value:e.id},null,8,["label","value"])):(0,d.kq)("",!0)],64)))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,d.Wm)(R,{label:"图集摘要"},{default:(0,d.w5)((()=>[(0,d.Wm)(Y,{modelValue:(0,u.SU)(O).data.desc,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,u.SU)(O).data.desc=e),type:"textarea"},null,8,["modelValue"])])),_:1}),(0,d.Wm)($,null,{default:(0,d.w5)((()=>[(0,d.Wm)(R,{label:"缩略图"},{default:(0,d.w5)((()=>[(0,d._)("div",S,[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(T.value,((e,l)=>((0,d.wg)(),(0,d.iD)("div",{key:e,class:"img mx-2"},[(0,d._)("img",{class:"w-full h-full",src:(0,u.SU)(w.v).BASE_URL+e},null,8,V),(0,d.Wm)(v,{size:24,color:"#777",onClick:e=>F(l)},{default:(0,d.w5)((()=>[(0,d.Wm)(Q)])),_:2},1032,["onClick"])])))),128)),P.value>0?((0,d.wg)(),(0,d.iD)("div",{key:0,class:"select-img mx-2",onClick:L},[(0,d.Wm)(v,{size:30},{default:(0,d.w5)((()=>[(0,d.Wm)(ee)])),_:1})])):(0,d.kq)("",!0)])])),_:1})])),_:1}),(0,d.Wm)(R,null,{default:(0,d.w5)((()=>[(0,d._)("div",b,[(0,d.Wm)((0,u.SU)(a),{class:"editTool",editor:(0,u.SU)(j),defaultConfig:(0,u.SU)(D),mode:(0,u.SU)(x)},null,8,["editor","defaultConfig","mode"]),(0,d.Wm)((0,u.SU)(l),{class:"editCtx",style:{height:"400px"},modelValue:(0,u.SU)(O).data.content,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,u.SU)(O).data.content=e),defaultConfig:(0,u.SU)(H),mode:(0,u.SU)(x),onOnCreated:(0,u.SU)(q)},null,8,["modelValue","defaultConfig","mode","onOnCreated"])])])),_:1}),(0,d.Wm)(R,null,{default:(0,d.w5)((()=>[A.value?((0,d.wg)(),(0,d.j4)(g,{key:1,type:"primary",onClick:J},{default:(0,d.w5)((()=>[Z])),_:1})):((0,d.wg)(),(0,d.j4)(g,{key:0,type:"primary",onClick:M},{default:(0,d.w5)((()=>[C])),_:1}))])),_:1})])),_:1},8,["model"])]),(0,d.Wm)(_.Z,{ref:"lib",modelValue:E.value,"onUpdate:modelValue":t[6]||(t[6]=e=>E.value=e),num:P.value,fatherFun:I},null,8,["modelValue","num"])])}}}),x=a(3744);const D=(0,x.Z)(j,[["__scopeId","data-v-79755db1"]]);var H=D}}]);